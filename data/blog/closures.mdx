---
title: What is a closure?
date: '2021-12-14'
tags: ['javascript']
draft: false
summary: What is a closure in JavaScript? An explanation with examples
---

## TL;DR, show me the code!

```jsx
function outerFn() {
  let message = 'pickles'
  function innerFn() {
    return message // <- this function is a closure
  }
  return innerFn()
}

outerFn() // 'pickles'
```

A closure is a fancy term you'll hear that refers to something that's actually fairly simple. A closure is a function that has been wrapped, or _enclosed_ by another function. The significance of this is that a variable declared in the outer function will also be accessible in the inner function.

Let's take a deep dive into the code above. The variable `message` with the value of `'pickles'` is created in `outerFn()`. Another function is created within `outerFn()` called `innerFn()` which just returns `message`. But how does it have access to it? Does it work the other way around? Does `outerFn()` have access to a hypothetical variable declared in `innerFn()`?

Let's try! Does the code below work? What will the output be?

```jsx
function outerFn() {
  function innerFn() {
    let breakfast = 'porridge'
  }
  return breakfast
}

outerFn() // ???
```

Take some time to think about it, go through each line and take an educated guess.

<br />
<br />
<br />
<br />
<br />
<br />
<br />
<br />
<br />
<br />
<br />
<br />
<br />
<br />
<br />
<br />
<br />
<br />
<br />
<br />
<br />
<br />
<br />
<br />
<br />

Have you made a guess ðŸ‘€ ?

<br />
<br />
<br />
<br />
<br />
<br />
<br />
<br />
<br />
<br />
<br />
<br />
<br />
<br />
<br />
<br />
<br />
<br />
<br />
<br />
<br />
<br />
<br />
<br />
<br />

It wouldn't work because `breakfast` is not defined.

```jsx
function outerFn() {
  function innerFn() {
    let breakfast = 'porridge'
  }
  return breakfast
}

outerFn() // Uncaught ReferenceError: breakfast is not defined
```

Why is this? Well the way closures work in JavaScript means that a function has access to it's outer lexical scope, but this only works in one direction; i.e. from the inside out. In the example above, the variable `breakfast` is declared in the `innerFn()` function but is called in the function outside it (`outerFn()`). `outerFn()` cannot look inside it's nested functions, so to the outer function, `breakfast` doesn't exist.

Ok so now we know what a closure is, but why are they useful?

Let's start with the big one; data encapsulation. With closures we can keep data closed off from the application and make available only when necessary. This means anything you create will stay in the function and not affect any other part of the codebase. Here's an example:

```jsx
let score = 0

function outerFn() {
  let score = 10
  function innerFn() {
    return score
  }
  return innerFn()
}
```

We create a variable called `score` and assign it a value of `0`. We then create another variable called `score` inside the `outer()` function and give it the value of `10`. At this point, we might be a bit tied up! What is the value of `score`?! Is it `0` or `10`.

The answer depends what part of the code is being run. If we're outside in the global space, `score` will be `0`, but inside the `outerFn()` function, `score` is now `10`. The `score` declared outside of `outerFn()` would still be accessible, but we've declared a new `score` variable, so to `outerFn()`, `score` is now `10`.

console.log(outerFn()) // 10
console.log(score) // 0

Something else we can do with closures is data persistence.

Patterns: modules, memoization, currying

Can give functions memories

The typical usecase of a function is to be used and return a value. With closures, we can store information in them, state, data, etc.

Cache persistent memory

Functions inside a functions aren't callable outside of function. Because the outer function has it's own local execution context. And the inner function only exists inside of it.

References:
https://www.youtube.com/watch?v=XTAzsODSCsM&t=123s
